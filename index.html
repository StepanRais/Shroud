<!DOCTYPE html>
<html>
  <head>
    <title>–ú–∞–≥–∞–∑–∏–Ω –º–µ—Ä—á–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
      body {
        margin: 0;
        font-family: Arial, sans-serif;
        background-color: #1c2526;
        color: #ffffff;
      }
      .container {
        padding: 10px;
        padding-bottom: 60px; /* –û—Ç—Å—Ç—É–ø –¥–ª—è –Ω–∏–∂–Ω–µ–π –ø–∞–Ω–µ–ª–∏ */
        max-width: 600px; /* –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —à–∏—Ä–∏–Ω—É –¥–ª—è –±–æ–ª—å—à–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        margin: 0 auto; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
      }
      .screen {
        display: none;
      }
      .screen.active {
        display: block;
      }

      /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞ */
      .search-bar {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
      }
      .search-bar input {
        flex: 1;
        padding: 8px;
        border: none;
        border-radius: 5px 0 0 5px;
        background-color: #333;
        color: #fff;
      }
      .search-bar .search-icon {
        padding: 8px;
        background-color: #333;
        border-radius: 0 5px 5px 0;
      }
      .search-bar .filter-btn {
        margin-left: 10px;
        padding: 8px;
        background-color: #333;
        border: none;
        border-radius: 5px;
        color: #fff;
        cursor: pointer;
      }
      .catalog {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
      }
      .product {
        background-color: #333;
        padding: 10px;
        border-radius: 5px;
        text-align: center;
        cursor: pointer;
      }
      .product-image-container {
        width: 100%;
        aspect-ratio: 1 / 1; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω (–∫–≤–∞–¥—Ä–∞—Ç) */
        overflow: hidden;
        border-radius: 5px;
      }
      .product-image-container img {
        width: 100%;
        height: 100%;
        object-fit: cover; /* –û–±—Ä–µ–∑–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ */
        object-position: center;
      }
      .product h3 {
        font-size: 14px;
        margin: 5px 0;
      }
      .product p {
        font-size: 12px;
        margin: 2px 0;
      }
      .stars {
        display: flex;
        justify-content: center;
        gap: 2px;
      }
      .stars .star {
        color: #ff0000;
        font-size: 12px;
      }

      /* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç–æ–≤–∞—Ä–∞ */
      .product-page {
        text-align: center;
      }
      .close-btn {
        position: absolute;
        top: 10px;
        left: 10px;
        background: none;
        border: none;
        color: #ff0000;
        font-size: 24px;
        cursor: pointer;
      }
      .product-image {
        position: relative;
        width: 100%;
        max-width: 300px;
        aspect-ratio: 1 / 1; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω */
        margin: 0 auto;
        overflow: hidden;
        border-radius: 5px;
      }
      .product-image img {
        width: 100%;
        height: 100%;
        object-fit: cover; /* –û–±—Ä–µ–∑–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ */
        object-position: center;
      }
      .arrow {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(0, 0, 0, 0.5);
        color: #fff;
        border: none;
        padding: 10px;
        cursor: pointer;
        font-size: 20px;
      }
      .arrow.left {
        left: 0;
      }
      .arrow.right {
        right: 0;
      }
      .product-details {
        margin-top: 10px;
      }
      .product-details h2 {
        font-size: 18px;
        margin: 5px 0;
      }
      .product-details p {
        font-size: 14px;
        margin: 2px 0;
      }
      .add-to-cart-btn {
        background-color: #333;
        color: #fff;
        padding: 10px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        margin-top: 10px;
        width: 100%;
        max-width: 300px;
      }

      /* –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å */
      .bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background-color: #333;
        display: flex;
        justify-content: space-around;
        padding: 10px 0;
      }
      .bottom-nav button {
        background: none;
        border: none;
        color: #fff;
        font-size: 24px;
        cursor: pointer;
      }

      /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –±–æ–ª—å—à–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
      @media (min-width: 600px) {
        .catalog {
          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- –≠–∫—Ä–∞–Ω –∫–∞—Ç–∞–ª–æ–≥–∞ -->
      <div class="screen active" id="catalogScreen">
        <div class="search-bar">
          <input type="text" placeholder="–ü–æ–∏—Å–∫..." id="searchInput" />
          <span class="search-icon">üîç</span>
          <button class="filter-btn" onclick="showFilters()">–§–∏–ª—å—Ç—Ä—ã ‚öôÔ∏è</button>
        </div>
        <div class="catalog" id="catalog"></div>
      </div>

      <!-- –≠–∫—Ä–∞–Ω —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç–æ–≤–∞—Ä–∞ -->
      <div class="screen" id="productScreen">
        <button class="close-btn" onclick="showScreen('catalogScreen')">
          ‚úñ
        </button>
        <div class="product-page" id="productPage"></div>
      </div>
    </div>

    <div class="bottom-nav">
      <button onclick="showScreen('catalogScreen')">üìã</button>
      <button onclick="showCart()">üõí</button>
      <button onclick="showReviews()">üí¨</button>
    </div>

    <script>
      // –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
      const products = [
        {
          id: 1,
          name: "Bal Sagoth",
          year: 1999,
          size: "XL",
          price: 6000,
          images: ["./images/bal.jpg", "./images/bal2.jpg"],
          category: "–§—É—Ç–±–æ–ª–∫–∞",
          condition: 5,
        },
        {
          id: 2,
          name: "Incarnated",
          year: 1999,
          size: "L",
          price: 8000,
          images: ["./images/incar.jpg", "./images/incar2.jpg"],
          category: "–§—É—Ç–±–æ–ª–∫–∞",
          condition: 5,
        },
        {
          id: 3,
          name: "Opeth",
          year: 2002,
          size: "L",
          price: 4500,
          images: ["./images/Opeth.jpg", "./images/Opeth2.jpg"],
          category: "–§—É—Ç–±–æ–ª–∫–∞",
          condition: 5,
        },
        {
          id: 4,
          name: "SOAD",
          year: 2001,
          size: "M/L",
          price: 7500,
          images: ["./images/Soad.jpg", "./images/Soad2.jpg"],
          category: "–§—É—Ç–±–æ–ª–∫–∞",
          condition: 5,
        },
      ];

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web Apps
      const tg = window.Telegram.WebApp;
      tg.ready();

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞
      function renderCatalog(filteredProducts = products) {
        const catalogDiv = document.getElementById("catalog");
        catalogDiv.innerHTML = ""; // –û—á–∏—â–∞–µ–º –∫–∞—Ç–∞–ª–æ–≥

        filteredProducts.forEach((product) => {
          const productDiv = document.createElement("div");
          productDiv.className = "product";
          productDiv.innerHTML = `
          <div class="product-image-container">
            <img src="${product.images[0]}" alt="${product.name}">
          </div>
          <h3>${product.name}</h3>
          <p>${product.year} ${product.size}</p>
          <p>${product.price}‚ÇΩ</p>
          <div class="stars">${renderStars(product.condition)}</div>
        `;
          productDiv.onclick = () => showProductPage(product.id);
          catalogDiv.appendChild(productDiv);
        });
      }

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç–æ–≤–∞—Ä–∞
      let currentImageIndex = 0;
      function showProductPage(productId) {
        const product = products.find((p) => p.id === productId);
        currentImageIndex = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–Ω–¥–µ–∫—Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

        const productPageDiv = document.getElementById("productPage");
        productPageDiv.innerHTML = `
        <div class="product-image">
          <img src="${product.images[currentImageIndex]}" alt="${
          product.name
        }" id="productImage">
          <button class="arrow left" onclick="changeImage(-1)">‚¨Ö</button>
          <button class="arrow right" onclick="changeImage(1)">‚û°</button>
        </div>
        <div class="product-details">
          <h2>${product.name}</h2>
          <p>–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${product.category}</p>
          <p>–†–∞–∑–º–µ—Ä: ${product.size}</p>
          <p>–¶–µ–Ω–∞: ${product.price}‚ÇΩ</p>
          <button class="add-to-cart-btn" onclick="addToCart(${
            product.id
          })">–î–û–ë–ê–í–ò–¢–¨ –í –ö–û–†–ó–ò–ù–£</button>
          <p>–°–æ—Å—Ç–æ—è–Ω–∏–µ:</p>
          <div class="stars">${renderStars(product.condition)}</div>
        </div>
      `;
        showScreen("productScreen");
      }

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–º–µ–Ω—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
      function changeImage(direction) {
        const product = products.find((p) => p.id === getCurrentProductId());
        currentImageIndex =
          (currentImageIndex + direction + product.images.length) %
          product.images.length;
        document.getElementById("productImage").src =
          product.images[currentImageIndex];
      }

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ ID —Ç–æ–≤–∞—Ä–∞ (–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ)
      function getCurrentProductId() {
        const productName = document.querySelector(
          ".product-details h2"
        ).textContent;
        return products.find((p) => p.name === productName).id;
      }

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–≤–µ–∑–¥
      function renderStars(count) {
        let stars = "";
        for (let i = 0; i < 5; i++) {
          stars += `<span class="star">${i < count ? "‚òÖ" : "‚òÜ"}</span>`;
        }
        return stars;
      }

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–æ–≤
      function showScreen(screenId) {
        document.querySelectorAll(".screen").forEach((screen) => {
          screen.classList.remove("active");
        });
        document.getElementById(screenId).classList.add("active");
        if (screenId === "catalogScreen") {
          renderCatalog();
        }
      }

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞
      document.getElementById("searchInput").addEventListener("input", (e) => {
        const searchTerm = e.target.value.toLowerCase();
        const filteredProducts = products.filter((product) =>
          product.name.toLowerCase().includes(searchTerm)
        );
        renderCatalog(filteredProducts);
      });

      // –§—É–Ω–∫—Ü–∏–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
      function showCart() {
        alert("–û—Ç–∫—Ä—ã–≤–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É!");
      }

      function showReviews() {
        alert("–û—Ç–∫—Ä—ã–≤–∞–µ–º –æ—Ç–∑—ã–≤—ã!");
      }

      function showFilters() {
        alert("–û—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∏–ª—å—Ç—Ä—ã!");
      }

      function addToCart(productId) {
        const product = products.find((p) => p.id === productId);
        alert(`${product.name} –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!`);
        tg.MainButton.setText("–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É");
        tg.MainButton.show();
      }

      tg.MainButton.onClick(() => {
        showCart();
      });

      // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–∞—Ç–∞–ª–æ–≥ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
      renderCatalog();
    </script>
  </body>
</html>
